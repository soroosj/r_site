---
title: Digging into BVB Dortmund Football Club's Tweets with R
author: Joel Soroos
date: '2020-12-12'
slug: twitter
categories: []
tags:
  - tidyverse
  - r
  - rstats
  - gt
  - rtweet
  - ggmap
---



<div id="purpose" class="section level2">
<h2>Purpose</h2>
<p>The goal of this post is to source and analyze Twitter posts and followers for a given Twitter account (“handle”) using R. We will identify tweets with the most likes and retweets, as well as posting trends over time. We will also map the geographic distribution of Twitter followers by leveraging Google Maps API attributes.</p>
<p>The example Twitter handle will be the English language account of <a href="https://www.bvb.de/eng">BVB Dortmund (“BVB”)</a>, a football team in Germany’s top professional league, the <a href="https://www.bundesliga.com/en/bundesliga">Bundesliga</a>. We are using BVB’s English Twitter account instead of the club’s primary German language Twitter account because this blog post is written in English.</p>
</div>
<div id="setup" class="section level2">
<h2>1. Setup</h2>
<p>First, we need to obtain and authorize a free Twitter Developer account (instructions <a href="https://cran.r-project.org/web/packages/rtweet/vignettes/auth.html">here</a>).</p>
<p>Second step is to install and load the R <a href="https://cran.r-project.org/web/packages/rtweet/rtweet.pdf">rtweet</a> package by Michael Kearney.</p>
<p>We will extract Twitter data multiple times so I have created two variables to avoid duplication and inconsistencies. The “twitter_user” variable stores the Twitter handle. The “sample” variable specifies the number of extracted records as some Twitter accounts have large volumes of followers and tweets.</p>
<pre class="r"><code>   library (rtweet)
   library (tidyverse)

   twitter_user &lt;- &quot;@blackyellow&quot;</code></pre>
</div>
<div id="analyze-tweets" class="section level2">
<h2>2. Analyze tweets</h2>
<div id="source-tweets" class="section level3">
<h3>Source tweets</h3>
<p>Now we will extract our first set of Twitter data.</p>
<p>The get_timeline function contains 90 fields for each tweet. The BVB account posts frequently so we will limit to the last 500 tweets.</p>
<pre class="r"><code>   tweets_raw &lt;- get_timeline (twitter_user, n = 500)</code></pre>
</div>
<div id="transform-tweets" class="section level3">
<h3>Transform Tweets</h3>
<p>Many fields are not needed for this exercise so we can cull the dataset. I have also renamed several fields for brevity and more standard Twitter notation (i.e. likes instead of favorites).</p>
<p>We are focusing on original tweets so have filtered out retweets.</p>
<p>I have extracted year from the creation date to enable summarizing tweet volume by year. Also, I have truncated the Tweet text field from 280 to 60 characters so more cleanly fits in a formatted table.</p>
<pre class="r"><code>   library (lubridate)

   tweets &lt;- tweets_raw %&gt;%
      filter (is_retweet == FALSE) %&gt;%
      rename (
         likes = favorite_count,
         retweets = retweet_count,
         created = created_at
         ) %&gt;%
      mutate (
         text = str_sub(text,1,60),
         created = as.Date(created),
         year = year(created)
         ) %&gt;%
      rename(date = created) %&gt;%
      select (text, date, year, likes, retweets)</code></pre>
</div>
<div id="visualize-most-liked-tweets" class="section level3">
<h3>Visualize most liked tweets</h3>
<p>We will sort by most liked tweets over time and rank via the dplyr row_to_column formula.</p>
<p>The <a href="https://gt.rstudio.com/">GT package</a> by Richard Iannone formats tables in a easy-to-read manner. The core gt::gt function adds lines between rows. Many other table formatting enhancements are available but out of scope for this blog.</p>
<p>The tweet with the most likes was BVB’s tribute to football legend Diego Maradona, who recently passed away.</p>
<pre class="r"><code>   library (gt)

   tweets %&gt;%
      arrange (-likes, -retweets) %&gt;%
      head (10) %&gt;%
      rowid_to_column(&quot;rank&quot;) %&gt;%
      select (-year) %&gt;%
      relocate (rank) %&gt;%
      gt () </code></pre>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#zdeaaziycb .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zdeaaziycb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zdeaaziycb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zdeaaziycb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zdeaaziycb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zdeaaziycb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zdeaaziycb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zdeaaziycb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zdeaaziycb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zdeaaziycb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zdeaaziycb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zdeaaziycb .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#zdeaaziycb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zdeaaziycb .gt_from_md > :first-child {
  margin-top: 0;
}

#zdeaaziycb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zdeaaziycb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zdeaaziycb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#zdeaaziycb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zdeaaziycb .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#zdeaaziycb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zdeaaziycb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zdeaaziycb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zdeaaziycb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zdeaaziycb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zdeaaziycb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#zdeaaziycb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zdeaaziycb .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#zdeaaziycb .gt_left {
  text-align: left;
}

#zdeaaziycb .gt_center {
  text-align: center;
}

#zdeaaziycb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zdeaaziycb .gt_font_normal {
  font-weight: normal;
}

#zdeaaziycb .gt_font_bold {
  font-weight: bold;
}

#zdeaaziycb .gt_font_italic {
  font-style: italic;
}

#zdeaaziycb .gt_super {
  font-size: 65%;
}

#zdeaaziycb .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="zdeaaziycb" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">rank</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">text</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">likes</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">retweets</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_center">1</td>
      <td class="gt_row gt_left">Rest In Peace, Diego Armando Maradona 🙏 https://t.co/JB0DiVE</td>
      <td class="gt_row gt_left">2020-11-25</td>
      <td class="gt_row gt_center">39019</td>
      <td class="gt_row gt_center">2541</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">2</td>
      <td class="gt_row gt_left">Your 2020 Golden Boy Award Winner:

⭐️ ERRRRRLIIINNNGG HAAAA</td>
      <td class="gt_row gt_left">2020-11-21</td>
      <td class="gt_row gt_center">25891</td>
      <td class="gt_row gt_center">1462</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">3</td>
      <td class="gt_row gt_left">“Only two?” 😂 https://t.co/OHcaIkNGnt</td>
      <td class="gt_row gt_left">2020-11-24</td>
      <td class="gt_row gt_center">23053</td>
      <td class="gt_row gt_center">1004</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_left">He is not real.</td>
      <td class="gt_row gt_left">2020-11-21</td>
      <td class="gt_row gt_center">21003</td>
      <td class="gt_row gt_center">1010</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_left">Just another day in the office 🎮 https://t.co/yE1IpiC6gc</td>
      <td class="gt_row gt_left">2020-11-26</td>
      <td class="gt_row gt_center">19328</td>
      <td class="gt_row gt_center">359</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">6</td>
      <td class="gt_row gt_left">He's the Golden Boy for a reason</td>
      <td class="gt_row gt_left">2020-11-21</td>
      <td class="gt_row gt_center">16179</td>
      <td class="gt_row gt_center">788</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">7</td>
      <td class="gt_row gt_left">The Goalden Boy 🥅⚽️ https://t.co/XgIiDyKcC2</td>
      <td class="gt_row gt_left">2020-11-22</td>
      <td class="gt_row gt_center">13388</td>
      <td class="gt_row gt_center">354</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">8</td>
      <td class="gt_row gt_left">Hakuna Matata - Marco Reus 🤙 https://t.co/PlTGdBLrhg</td>
      <td class="gt_row gt_left">2020-11-28</td>
      <td class="gt_row gt_center">12865</td>
      <td class="gt_row gt_center">1520</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">9</td>
      <td class="gt_row gt_left">Are you excited for the international break to end? 

Yes   </td>
      <td class="gt_row gt_left">2020-11-18</td>
      <td class="gt_row gt_center">12740</td>
      <td class="gt_row gt_center">494</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">10</td>
      <td class="gt_row gt_left">Sweet Sixteen, Youssoufa Moukoko 🥳🎂 https://t.co/UaGEFhV0hC</td>
      <td class="gt_row gt_left">2020-11-20</td>
      <td class="gt_row gt_center">11925</td>
      <td class="gt_row gt_center">385</td>
    </tr>
  </tbody>
  
  
</table></div>
</div>
<div id="visualize-most-retweeted-tweets" class="section level3">
<h3>Visualize most retweeted tweets</h3>
<p>Next we will re-sort and re-rank by retweets, again using the GT package to cleanly format.</p>
<p>A tweet celebrating player striker Giovanni Reyna signing a contract extension produced the most retweets. The tribute to Argentine football legend Diego Maradona (most liked tweet) was #2 when ranking by retweets.</p>
<pre class="r"><code>   tweets %&gt;%
      arrange (-retweets, -likes) %&gt;%
      head (10) %&gt;%
      rowid_to_column(&quot;rank&quot;) %&gt;%
      select (rank, text, date, retweets, likes) %&gt;%
      gt ()</code></pre>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#lwfzrurnxe .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lwfzrurnxe .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lwfzrurnxe .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lwfzrurnxe .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lwfzrurnxe .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lwfzrurnxe .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lwfzrurnxe .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lwfzrurnxe .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lwfzrurnxe .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lwfzrurnxe .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lwfzrurnxe .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lwfzrurnxe .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#lwfzrurnxe .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lwfzrurnxe .gt_from_md > :first-child {
  margin-top: 0;
}

#lwfzrurnxe .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lwfzrurnxe .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lwfzrurnxe .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#lwfzrurnxe .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lwfzrurnxe .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#lwfzrurnxe .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lwfzrurnxe .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lwfzrurnxe .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lwfzrurnxe .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lwfzrurnxe .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lwfzrurnxe .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#lwfzrurnxe .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lwfzrurnxe .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#lwfzrurnxe .gt_left {
  text-align: left;
}

#lwfzrurnxe .gt_center {
  text-align: center;
}

#lwfzrurnxe .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lwfzrurnxe .gt_font_normal {
  font-weight: normal;
}

#lwfzrurnxe .gt_font_bold {
  font-weight: bold;
}

#lwfzrurnxe .gt_font_italic {
  font-style: italic;
}

#lwfzrurnxe .gt_super {
  font-size: 65%;
}

#lwfzrurnxe .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="lwfzrurnxe" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">rank</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">text</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">retweets</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">likes</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_center">1</td>
      <td class="gt_row gt_left">🚨 #REYNA2025 GIVEAWAY 🚨

To celebrate Gio’s contract extensi</td>
      <td class="gt_row gt_left">2020-11-21</td>
      <td class="gt_row gt_center">4926</td>
      <td class="gt_row gt_center">3328</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">2</td>
      <td class="gt_row gt_left">Rest In Peace, Diego Armando Maradona 🙏 https://t.co/JB0DiVE</td>
      <td class="gt_row gt_left">2020-11-25</td>
      <td class="gt_row gt_center">2541</td>
      <td class="gt_row gt_center">39019</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">3</td>
      <td class="gt_row gt_left">Hakuna Matata - Marco Reus 🤙 https://t.co/PlTGdBLrhg</td>
      <td class="gt_row gt_left">2020-11-28</td>
      <td class="gt_row gt_center">1520</td>
      <td class="gt_row gt_center">12865</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_left">Your 2020 Golden Boy Award Winner:

⭐️ ERRRRRLIIINNNGG HAAAA</td>
      <td class="gt_row gt_left">2020-11-21</td>
      <td class="gt_row gt_center">1462</td>
      <td class="gt_row gt_center">25891</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_left">He is not real.</td>
      <td class="gt_row gt_left">2020-11-21</td>
      <td class="gt_row gt_center">1010</td>
      <td class="gt_row gt_center">21003</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">6</td>
      <td class="gt_row gt_left">“Only two?” 😂 https://t.co/OHcaIkNGnt</td>
      <td class="gt_row gt_left">2020-11-24</td>
      <td class="gt_row gt_center">1004</td>
      <td class="gt_row gt_center">23053</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">7</td>
      <td class="gt_row gt_left">63 | HAATTRICK!!!

THIS MAN IS NOT HUMAN!!!

#BSCBVB 1-3 htt</td>
      <td class="gt_row gt_left">2020-11-21</td>
      <td class="gt_row gt_center">844</td>
      <td class="gt_row gt_center">10091</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">8</td>
      <td class="gt_row gt_left">He's the Golden Boy for a reason</td>
      <td class="gt_row gt_left">2020-11-21</td>
      <td class="gt_row gt_center">788</td>
      <td class="gt_row gt_center">16179</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">9</td>
      <td class="gt_row gt_left">Just had to make sure 🤖 https://t.co/xScWp4Taw1</td>
      <td class="gt_row gt_left">2020-11-21</td>
      <td class="gt_row gt_center">749</td>
      <td class="gt_row gt_center">7233</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">10</td>
      <td class="gt_row gt_left">The last time we faced Frankfurt...💛🏟 https://t.co/hlg7Z18Dl</td>
      <td class="gt_row gt_left">2020-12-04</td>
      <td class="gt_row gt_center">597</td>
      <td class="gt_row gt_center">11384</td>
    </tr>
  </tbody>
  
  
</table></div>
</div>
<div id="visualize-number-of-tweets-trends" class="section level3">
<h3>Visualize number of tweets trends</h3>
<p>Another area of interest is how tweet activity has evolved over time. Using dplyr we can easily summarize by number of tweets by day.</p>
<p>The volume of tweets was smallest during the international break in early to mid November. BVB does not play games during international breaks because the players are away representing their respective national football teams.</p>
<pre class="r"><code>   tweets %&gt;%
      group_by (date) %&gt;%
      count () %&gt;%
      ggplot (aes (x = date, y = n)) +
         geom_col () +
         geom_label (aes(label = n)) +
         theme_minimal() +
         labs (x=&quot;&quot;, y = &quot;Number of tweets&quot;)</code></pre>
<p><img src="/post/twitter_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
</div>
<div id="analyze-twitter-followers" class="section level2">
<h2>3. Analyze Twitter followers</h2>
<div id="source-followers" class="section level3">
<h3>Source followers</h3>
<p>Learning about followers for a Twitter handle is also frequently useful.</p>
<p>Two rtweet package functions are helpful here. First, get_followers returns a vector of Twitter user_ids of followers. The lookup_users function then extracts user attributes such as screen name, physical location (if supplied in profile) and number of followers.</p>
<p>The BVB account enjoys 583,000 followers so we will limit to 500 users for this blog entry. This is not a representative sample and is provided for illustrating R’s visualization capabilities.</p>
<p>We will also add a row ID ranking each follower by largest number of followers via dplyr’s rowid_to_column function.</p>
<pre class="r"><code>   library(skimr)

  followers &lt;- twitter_user %&gt;%
      get_followers() %&gt;%
      head (500) %&gt;%
      pull (user_id) %&gt;%
      lookup_users () %&gt;%
      select (screen_name, name, location, followers_count) %&gt;%
      arrange (-followers_count) %&gt;%
      rowid_to_column(&quot;rank&quot;)

   skim (followers)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-5">Table 1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">followers</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">500</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">screen_name</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">15</td>
<td align="right">0</td>
<td align="right">500</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">name</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">43</td>
<td align="right">1</td>
<td align="right">500</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">location</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">30</td>
<td align="right">342</td>
<td align="right">146</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">rank</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">250.5</td>
<td align="right">144.48</td>
<td align="right">1</td>
<td align="right">125.75</td>
<td align="right">250.5</td>
<td align="right">375.25</td>
<td align="right">500</td>
<td align="left">▇▇▇▇▇</td>
</tr>
<tr class="even">
<td align="left">followers_count</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">209.0</td>
<td align="right">1636.61</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">7.0</td>
<td align="right">46.00</td>
<td align="right">30252</td>
<td align="left">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div id="top-followers" class="section level3">
<h3>Top followers</h3>
<p>We will first list the 10 largest followers by respective number of followers.</p>
<p>The follower from the sample with the most followers is winnie.</p>
<pre class="r"><code>   followers %&gt;%
      head (10) %&gt;%
      select (rank, name, location, followers_count) %&gt;%
      gt () %&gt;%
         fmt_number (columns = vars(followers_count), use_seps = T, decimals = 0)</code></pre>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#amltshcgkq .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#amltshcgkq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#amltshcgkq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#amltshcgkq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#amltshcgkq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#amltshcgkq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#amltshcgkq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#amltshcgkq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#amltshcgkq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#amltshcgkq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#amltshcgkq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#amltshcgkq .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#amltshcgkq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#amltshcgkq .gt_from_md > :first-child {
  margin-top: 0;
}

#amltshcgkq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#amltshcgkq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#amltshcgkq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#amltshcgkq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#amltshcgkq .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#amltshcgkq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#amltshcgkq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#amltshcgkq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#amltshcgkq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#amltshcgkq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#amltshcgkq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#amltshcgkq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#amltshcgkq .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#amltshcgkq .gt_left {
  text-align: left;
}

#amltshcgkq .gt_center {
  text-align: center;
}

#amltshcgkq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#amltshcgkq .gt_font_normal {
  font-weight: normal;
}

#amltshcgkq .gt_font_bold {
  font-weight: bold;
}

#amltshcgkq .gt_font_italic {
  font-style: italic;
}

#amltshcgkq .gt_super {
  font-size: 65%;
}

#amltshcgkq .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="amltshcgkq" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">rank</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">location</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">followers_count</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_center">1</td>
      <td class="gt_row gt_left">Spence Checketts</td>
      <td class="gt_row gt_left">Salt Lake City, Utah</td>
      <td class="gt_row gt_center">30,252</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">2</td>
      <td class="gt_row gt_left">شوقي</td>
      <td class="gt_row gt_left"></td>
      <td class="gt_row gt_center">16,916</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">3</td>
      <td class="gt_row gt_left">James Fielden</td>
      <td class="gt_row gt_left">London</td>
      <td class="gt_row gt_center">9,752</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_left">11.01🥂🎈</td>
      <td class="gt_row gt_left">Pretoria, South Africa</td>
      <td class="gt_row gt_center">3,386</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_left">feyyaz</td>
      <td class="gt_row gt_left">Sanliurfa, Turkey</td>
      <td class="gt_row gt_center">2,801</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">6</td>
      <td class="gt_row gt_left">Biyan Rizaldy</td>
      <td class="gt_row gt_left">Indonesia</td>
      <td class="gt_row gt_center">2,800</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">7</td>
      <td class="gt_row gt_left">Ashwin Appiah</td>
      <td class="gt_row gt_left">Seattle, WA</td>
      <td class="gt_row gt_center">2,592</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">8</td>
      <td class="gt_row gt_left">TheGreekMamba 🇬🇷🇨🇦</td>
      <td class="gt_row gt_left">Toronto, Ontario</td>
      <td class="gt_row gt_center">2,358</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">9</td>
      <td class="gt_row gt_left">Likes&amp;Retweets</td>
      <td class="gt_row gt_left">Nigeria</td>
      <td class="gt_row gt_center">2,009</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">10</td>
      <td class="gt_row gt_left">Dj Irakoze</td>
      <td class="gt_row gt_left">Kampala, Uganda</td>
      <td class="gt_row gt_center">1,951</td>
    </tr>
  </tbody>
  
  
</table></div>
</div>
<div id="obtain-follower-geographic-attributes" class="section level3">
<h3>Obtain follower geographic attributes</h3>
<p>Another interesting item to research on followers is geographic distribution.</p>
<p>The provided location in Twitter profile is a good starting point. However, locations are neither standardized by level of detail (city, country) nor spelling. Standardization is necessary to group in table or map.</p>
<p>We will standardize at the highest level of detail, which is country, via the <a href="https://developers.google.com/maps/documentation">Google Maps API</a> and accessed via the <a href="https://cran.r-project.org/web/packages/ggmap/ggmap.pdf">ggmaps package</a>. If this is the first time you have accessed the Google Maps API, you will need to complete a one-time step of obtaining a free Google maps API key (instructions <a href="https://rdrr.io/cran/ggmap/man/register_google.html">here</a>).</p>
<pre class="r"><code>   library (ggmap)

   register_google(key = Sys.getenv(&quot;GOOGLE_MAPS_API&quot;))

   followers_geo &lt;- followers %&gt;%
      mutate_geocode (location, output = &quot;more&quot;) %&gt;%
      mutate (
         country = word (address, -1, -1, sep = &quot;,&quot;),
         country = str_to_upper (country),
         country = str_trim(country),
         country = ifelse(is.na(country), &quot;NOT LISTED&quot;, country)
         ) %&gt;%
      select (rank:followers_count, country, address, lon, lat) 
   
   followers_geo</code></pre>
<pre><code>## # A tibble: 500 x 9
##     rank screen_name name  location followers_count country address      lon
##    &lt;int&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;              &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;
##  1     1 spencechec… Spen… &quot;Salt L…           30252 USA     salt l… -112.   
##  2     2 shawkiii14  شوقي  &quot;&quot;                 16916 NOT LI… &lt;NA&gt;      NA    
##  3     3 James_Fiel… Jame… &quot;London&quot;            9752 UK      london…   -0.128
##  4     4 MalomaPale… 11.0… &quot;Pretor…            3386 SOUTH … pretor…   28.2  
##  5     5 feyyyaz     feyy… &quot;Sanliu…            2801 TURKEY  şanlıu…   38.8  
##  6     6 biyanrizal… Biya… &quot;Indone…            2800 INDONE… indone…  114.   
##  7     7 ashwinappi… Ashw… &quot;Seattl…            2592 USA     seattl… -122.   
##  8     8 TheGreekMa… TheG… &quot;Toront…            2358 CANADA  toront…  -79.4  
##  9     9 folamisegun Like… &quot;Nigeri…            2009 NIGERIA nigeria    8.68 
## 10    10 DeejayIrak… Dj I… &quot;Kampal…            1951 UGANDA  kampal…   32.6  
## # … with 490 more rows, and 1 more variable: lat &lt;dbl&gt;</code></pre>
</div>
<div id="visualize-followers-by-country" class="section level3">
<h3>Visualize followers by country</h3>
<p>We will first identify the top follower countries and summarize in a GT table.</p>
<p>The largest countries of followers in the sample are US, UK and Nigeria. The wider population for BVB followers of the English language account may be significantly different as the first 500 accounts are pulled, which is not a representative sample. Additionally, many followers of BVB’s tweets follow sister accounts in different languages, such as the primary German language Twitter handle.</p>
<pre class="r"><code>   followers_agg &lt;- followers_geo %&gt;%
      count (country) %&gt;%
      filter (country != &quot;NOT LISTED&quot;) %&gt;%
      arrange (-n)
   
   ggplot (followers_agg, aes (x = reorder(country, n), y = n)) +
      geom_col () +
      coord_flip () +
      theme_minimal() +
      labs (x=&quot;&quot;, y = &quot;Followers&quot;)</code></pre>
<p><img src="/post/twitter_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="visualize-followers-on-a-map" class="section level3">
<h3>Visualize followers on a map</h3>
<p>Next we will convert to a map to enable viewing the location of all users along with countries with most users.</p>
<pre class="r"><code>   library (maps)

   world &lt;- map_data (&quot;world&quot;) %&gt;%
      mutate (region = str_to_upper (region)) %&gt;%
      left_join (followers_agg, by = c(&quot;region&quot; = &quot;country&quot;), keep = T) 
   
   world %&gt;%
      ggplot () +
         geom_map (map = world, aes (x = long, y = lat, map_id = region, fill = n)) +
         scale_fill_viridis_c () +
         theme_grey () </code></pre>
<p><img src="/post/twitter_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
</div>
<div id="potential-future-analyses" class="section level2">
<h2>4. Potential future analyses</h2>
<p>We are only scratching the surface of available Twitter data, subsequent data enrichment from complementary packages and subsequent analytics. Second generation followers (followers of followers) could easily be sourced and subtotaled to identify possible impact from a tweet. Or Twitter users that the account itself follows could also be extracted. Another idea is to convert the R code to Shiny to enable interactivity to efficiently change Twitter handles.</p>
</div>
<div id="conclusion" class="section level2">
<h2>5. Conclusion</h2>
<p>R offers many powerful tools to source, analyze and visualize Twitter information. The Twitter API (accessed via the rtweet package) enables free sourcing of follower and tweet attributes that can be easily imported into R. The raw data can then be enriched by sourcing geographic attributes from Google’s API via the ggmap package. Tidyverse package such as dplyr, ggplot and GT can then be leveraged to transform and visualize for insight.</p>
</div>
